C51 COMPILER V9.00   PAGE                                                                  01/08/2025 16:52:06 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE PAGE
OBJECT MODULE PLACED IN .\Objects\page.obj
COMPILER INVOKED BY: D:\Keil_v5\C51\BIN\C51.EXE ..\Code\page.c LARGE OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.
                    -\Listings\page.lst) TABS(2) OBJECT(.\Objects\page.obj)

line level    source

   1          #include "page.h"
   2          
   3          unsigned char blink_flag = 0; // é—ªçƒæ ‡è¯†ï¼Œç”¨äºä¸»é¡µçš„æ—¶é—´å­—ç¬¦ä¸²çš„é—ªçƒã€‚
   4          
   5          unsigned char isAlarmOn = 1; // æ ‡è¯†å½“å‰é—¹é’Ÿæ˜¯å¦æ‰“å¼€ï¼Œæ‰“å¼€ä¸º1ï¼Œå…³é—­ä¸º2
   6          
   7          unsigned char Alarm_Time[] = {0, 6, 3, 0}; // è®¾ç½®çš„é—¹é’Ÿå“é“ƒæ—¶é—´ï¼Œ6ç‚¹30ä¸ºä¸Šç”µé»˜è®¤æ—¶é—´
   8          
   9          unsigned char isShowSecond = 0; // æ˜¯å¦æ˜¾ç¤ºç§’æ•°
  10          
  11          unsigned char isShowYear = 0; // æ˜¯å¦æ˜¾ç¤ºå¹´ä»½
  12          
  13          unsigned char Time_Fontstyle = 1; // æ—¶é—´çš„å­—ä½“é£æ ¼
  14          
  15          /// @brief æ˜¾ç¤ºä¸»é¡µ
  16          void ShowPage_Home()
  17          {
  18   1          DS1302_ReadTime(); // è¯»å–æ—¶é—´
  19   1      
  20   1          if (isAlarmOn == 1)
  21   1          {
  22   2              OLED_DisplayCN(0, 0, 23); // æ ¹æ®å½“å‰é—¹é’Ÿå¼€å…³çŠ¶æ€ï¼Œåˆ¤æ–­æ˜¯å¦éœ€è¦æ˜¾ç¤ºé—¹é’Ÿæ ‡å¿—
             -ç¬¦å·
  23   2              Show_TimeString(16, 0, Alarm_Time, 4);
  24   2          }
  25   1          // else OLED_DisplayCN(0,0,19);
  26   1      
  27   1          Show_LargeTimeString(isShowSecond, Time_Fontstyle); // æ˜¾ç¤ºä¸»é¡µçš„å¤§å·æ—¶é—´ï¼ˆå‚æ•°æœ‰æ˜¯å¦æ˜
             -¾ç¤ºç§’ï¼Œå­—ä½“é£æ ¼ï¼‰
  28   1          Show_DataString(isShowYear, 0, 6);                  // æ˜¾ç¤ºä¸»é¡µçš„æ—¥æœŸï¼ˆå‚æ•°æœ‰æ˜¯å¦æ˜¾ç¤ºå¹
             -´ä»½ï¼‰
  29   1          Show_WeekString(0, 80, 6);                          // æ˜¾ç¤ºæ˜ŸæœŸå‡ 
  30   1      }
  31          
  32          /// @brief æ˜¾ç¤ºèœå•é¡µé¢
  33          void ShowPage_Menu()
  34          {
  35   1          unsigned char option;
  36   1      
  37   1          OLED_Fill(0);
  38   1      
  39   1          OLED_DisplayCN(16, 0, 10); // è®¾ç½®æ—¶é—´
  40   1          OLED_DisplayCN(32, 0, 11);
  41   1          OLED_DisplayCN(48, 0, 12);
  42   1          OLED_DisplayCN(64, 0, 13);
  43   1      
  44   1          OLED_DisplayCN(16, 2, 10); // è®¾ç½®æ—¥æœŸæ˜ŸæœŸ
  45   1          OLED_DisplayCN(32, 2, 11);
  46   1          OLED_DisplayCN(48, 2, 14);
  47   1          OLED_DisplayCN(64, 2, 15);
  48   1          OLED_DisplayCN(80, 2, 0);
  49   1          OLED_DisplayCN(96, 2, 1);
  50   1      
  51   1          OLED_DisplayCN(16, 4, 10); // è®¾ç½®é—¹é’Ÿ
C51 COMPILER V9.00   PAGE                                                                  01/08/2025 16:52:06 PAGE 2   

  52   1          OLED_DisplayCN(32, 4, 11);
  53   1          OLED_DisplayCN(48, 4, 16);
  54   1          OLED_DisplayCN(64, 4, 17);
  55   1      
  56   1          OLED_DisplayCN(16, 6, 24); // æ ·å¼è®¾ç½®
  57   1          OLED_DisplayCN(32, 6, 25);
  58   1          OLED_DisplayCN(48, 6, 10);
  59   1          OLED_DisplayCN(64, 6, 11);
  60   1      
  61   1          option = Show_SelectBar(4); // æ­¤å¤„é˜»å¡
  62   1      
  63   1          switch (option)
  64   1          {
  65   2          case 1:
  66   2              ShowPage_TimeSet();
  67   2              break;
  68   2          case 2:
  69   2              ShowPage_DateSet();
  70   2              break;
  71   2          case 3:
  72   2              ShowPage_AlarmSet();
  73   2              break;
  74   2          case 4:
  75   2              Show_PatternSet();
  76   2              break;
  77   2          default:
  78   2              break;
  79   2          }
  80   1          OLED_Fill(0);
  81   1      }
  82          
  83          /// @brief æ˜¾ç¤ºè°ƒæ•´æ—¶é—´çš„ç•Œé¢
  84          void ShowPage_TimeSet()
  85          {
  86   1          unsigned char i = 0; // ç”¨äºæ ‡è¯†å½“å‰æ­£è°ƒæ•´çš„ä½
  87   1      
  88   1          OLED_Fill(0);
  89   1          OLED_DisplayCN(32, 0, 10); // è®¾ç½®æ—¶é—´
  90   1          OLED_DisplayCN(48, 0, 11);
  91   1          OLED_DisplayCN(64, 0, 12);
  92   1          OLED_DisplayCN(80, 0, 13);
  93   1          while (i <= 3)
  94   1          {
  95   2              Show_TimeString(44, 2, DS1302_Time, 4);
  96   2              OLED_DisplayStr(44, 4, "        ");
  97   2              if (i > 1)
  98   2                  OLED_DisplayChar(44 + i * 8 + 8, 4, 127); // æ˜¾ç¤ºå°ç®­å¤´æŒ‡ç¤ºè°ƒæ•´çš„ä½,æ­¤å¤„ifä½œç”¨æ
             -˜¯ï¼Œå¦‚æœè°ƒæ•´åˆ†é’Ÿæ•°ã€iã€‹1ã€‘æƒ…å†µï¼Œéœ€è¦è·³è¿‡ä¸€ä¸ªå†’å·ã€‚
  99   2              else
 100   2                  OLED_DisplayChar(44 + i * 8, 4, 127);
 101   2      
 102   2              switch (Key_Scan_Blocked())
 103   2              {
 104   3              case 1: // oké”®ï¼Œå½“å‰ä½+1
 105   3                  DS1302_Time[i]++;
 106   3                  if (DS1302_Time[i] > 9)
 107   3                      DS1302_Time[i] = 0; // ä»»æ„ä¸€ä½éƒ½ä¸å…è®¸å¤§äº9
 108   3                  break;
 109   3              case 2: // åˆ‡ä½é”®ï¼Œè°ƒæ•´ä¸‹ä¸€ä½
 110   3                  i++;
 111   3                  break;
 112   3              case 3: // å–æ¶ˆé”®ï¼Œé€€å‡ºè°ƒæ•´ç¨‹åºï¼ˆä¸ä¿å­˜ï¼‰
C51 COMPILER V9.00   PAGE                                                                  01/08/2025 16:52:06 PAGE 3   

 113   3                  return;
 114   3              }
 115   2      
 116   2              if (DS1302_Time[0] * 10 + DS1302_Time[1] > 23 | DS1302_Time[0] * 10 + DS1302_Time[1] < 0) // åˆ¤æ–
             -­å½“å‰æ—¶é—´çš„åˆæ³•æ€§
 117   2              {
 118   3                  DS1302_Time[0] = 0;
 119   3                  DS1302_Time[1] = 0;
 120   3              }
 121   2              if (DS1302_Time[2] * 10 + DS1302_Time[3] > 59 | DS1302_Time[2] * 10 + DS1302_Time[3] < 0)
 122   2              {
 123   3                  DS1302_Time[2] = 0;
 124   3                  DS1302_Time[3] = 0;
 125   3              }
 126   2          }
 127   1          DS1302_SetTime();
 128   1      }
 129          
 130          /// @brief æ˜¾ç¤ºè°ƒæ•´æ—¥æœŸçš„ç•Œé¢
 131          void ShowPage_DateSet()
 132          {
 133   1          unsigned char i = 2; // ç”¨äºæ ‡è¯†å½“å‰æ­£è°ƒæ•´çš„ä½,ç”±äºå¼€å¤´çš„20xxæ˜¯å›ºå®šçš„ï¼Œæ‰€ä»¥ç›´æ
             -¥ä»ç¬¬äºŒä½å¼€å§‹è°ƒæ•´
 134   1      
 135   1          OLED_Fill(0);
 136   1          OLED_DisplayCN(16, 0, 10); // è®¾ç½®æ—¥æœŸæ˜ŸæœŸ
 137   1          OLED_DisplayCN(32, 0, 11);
 138   1          OLED_DisplayCN(48, 0, 14);
 139   1          OLED_DisplayCN(64, 0, 15);
 140   1          OLED_DisplayCN(80, 0, 0);
 141   1          OLED_DisplayCN(96, 0, 1);
 142   1      
 143   1          while (i <= 8)
 144   1          {
 145   2              Show_DataString(1, 1, 2);  // å±å¹•å…ˆåˆ—å‡ºå½“å‰çš„æ—¥æœŸ
 146   2              Show_WeekString(1, 96, 2); // å†åˆ—å‡ºå½“å‰æ˜ŸæœŸ
 147   2              OLED_DisplayStr(0, 4, "                ");
 148   2      
 149   2              // åˆ¤æ–­æŒ‡ç¤ºè°ƒæ•´ä½çš„å°ç®­å¤´åº”è¯¥æ˜¾ç¤ºåœ¨å“ªé‡Œ
 150   2              if (i == 4 | i == 5)
 151   2                  OLED_DisplayChar(0 + i * 8 + 8, 4, 127); // æ˜¾ç¤ºå°ç®­å¤´æŒ‡ç¤ºè°ƒæ•´çš„ä½,æ­¤å¤„ifä½œç”¨æ˜
             -¯ï¼Œå¦‚æœè°ƒæ•´æœˆä»½ã€iã€‹3ã€‘æƒ…å†µï¼Œéœ€è¦è·³è¿‡ä¸€ä¸ªå†’å·ã€‚
 152   2              else if (i == 6 | i == 7)
 153   2                  OLED_DisplayChar(0 + i * 8 + 16, 4, 127); // æ˜¾ç¤ºå°ç®­å¤´æŒ‡ç¤ºè°ƒæ•´çš„ä½,æ­¤å¤„ifä½œç”¨æ
             -˜¯ï¼Œå¦‚æœè°ƒæ•´æ—¥æœŸã€iã€‹5ã€‘æƒ…å†µï¼Œéœ€è¦è·³è¿‡2ä¸ªå†’å·ã€‚
 154   2              else if (i == 8)
 155   2                  OLED_DisplayChar(119, 4, 127); // i=8æ—¶ï¼Œè°ƒæ•´çš„æ˜¯æ˜ŸæœŸï¼Œç®­å¤´æ˜¾ç¤ºåˆ°æ˜ŸæœŸå¤„
 156   2              else
 157   2                  OLED_DisplayChar(0 + i * 8, 4, 127);
 158   2      
 159   2              switch (Key_Scan_Blocked()) // æ‰«ææŒ‰é”®ï¼Œè°ƒæ•´æ—¥æœŸä¸­
 160   2              {
 161   3              case 1:        // oké”®ï¼Œå½“å‰ä½+1
 162   3                  if (i < 8) // å¤„äºè°ƒæ•´æ—¥æœŸçš„çŠ¶æ€ä¸‹
 163   3                  {
 164   4                      DS1302_Date[i]++;
 165   4                      if (DS1302_Date[i] > 9)
 166   4                          DS1302_Date[i] = 0; // ä»»æ„ä¸€ä½éƒ½ä¸å…è®¸å¤§äº9
 167   4                  }
 168   3                  else // è°ƒæ•´çš„æ˜¯æ˜ŸæœŸ
 169   3                  {
 170   4                      DS1302_Week++;
C51 COMPILER V9.00   PAGE                                                                  01/08/2025 16:52:06 PAGE 4   

 171   4                      if (DS1302_Week == 8)
 172   4                          DS1302_Week = 1;
 173   4                  }
 174   3                  break;
 175   3              case 2: // åˆ‡ä½é”®ï¼Œè°ƒæ•´ä¸‹ä¸€ä½
 176   3                  i++;
 177   3                  break;
 178   3              case 3: // å–æ¶ˆé”®ï¼Œé€€å‡ºè°ƒæ•´ç¨‹åºï¼ˆä¸ä¿å­˜ï¼‰
 179   3                  return;
 180   3              }
 181   2      
 182   2              if (DS1302_Date[2] * 10 + DS1302_Date[3] > 99) // åˆ¤æ–­å½“å‰æ—¥æœŸçš„åˆæ³•æ€§
 183   2              {
 184   3                  DS1302_Date[2] = 0;
 185   3                  DS1302_Date[3] = 0;
 186   3              }
 187   2              if (DS1302_Date[4] * 10 + DS1302_Date[5] > 12 | DS1302_Date[4] * 10 + DS1302_Date[5] < 1)
 188   2              {
 189   3                  DS1302_Date[4] = 0;
 190   3                  DS1302_Date[5] = 1;
 191   3              }
 192   2              if (DS1302_Date[6] * 10 + DS1302_Date[7] > 31 | DS1302_Date[6] * 10 + DS1302_Date[7] < 1)
 193   2              {
 194   3                  DS1302_Date[6] = 0;
 195   3                  DS1302_Date[7] = 1;
 196   3              }
 197   2          }
 198   1          DS1302_SetDate();
 199   1          DS1302_SetWeek();
 200   1      }
 201          
 202          /// @brief æ˜¾ç¤ºé—¹é’Ÿè®¾ç½®
 203          void ShowPage_AlarmSet()
 204          {
 205   1          unsigned char option;
 206   1      
 207   1          OLED_Fill(0);
 208   1      
 209   1          OLED_DisplayCN(16, 0, 16); // é—¹é’Ÿæ—¶é—´
 210   1          OLED_DisplayCN(32, 0, 17);
 211   1          OLED_DisplayCN(48, 0, 12);
 212   1          OLED_DisplayCN(64, 0, 13);
 213   1          Show_TimeString(80, 0, Alarm_Time, 4);
 214   1      
 215   1          OLED_DisplayCN(16, 2, 16); // é—¹é’Ÿå¼€ï¼ˆæˆ–é—¹é’Ÿå…³ï¼Œæ ¹æ®isalarmonçš„å€¼æ¥ç¡®å®šæ˜¾ç¤ºä»€ä¹ˆï¼‰
 216   1          OLED_DisplayCN(32, 2, 17);
 217   1          if (isAlarmOn == 0)
 218   1              OLED_DisplayCN(48, 2, 20);
 219   1          else
 220   1              OLED_DisplayCN(48, 2, 21);
 221   1      
 222   1          option = Show_SelectBar(2);
 223   1          switch (option)
 224   1          {
 225   2          case 1:
 226   2              Show_AlarmTimeSet();
 227   2              break;
 228   2          case 2:
 229   2              if (isAlarmOn == 0)
 230   2                  isAlarmOn = 1;
 231   2              else
 232   2                  isAlarmOn = 0;
C51 COMPILER V9.00   PAGE                                                                  01/08/2025 16:52:06 PAGE 5   

 233   2              break;
 234   2          default:
 235   2              break;
 236   2          }
 237   1      }
 238          
 239          /// @brief æ˜¾ç¤ºè°ƒæ•´é—¹é’Ÿæ—¶é—´çš„å­é¡µé¢
 240          void Show_AlarmTimeSet()
 241          {
 242   1          unsigned char i = 0; // ç”¨äºæ ‡è¯†å½“å‰æ­£è°ƒæ•´çš„ä½
 243   1      
 244   1          OLED_Fill(0);
 245   1          OLED_DisplayCN(32, 0, 16); // é—¹é’Ÿæ—¶é—´
 246   1          OLED_DisplayCN(48, 0, 17);
 247   1          OLED_DisplayCN(64, 0, 12);
 248   1          OLED_DisplayCN(80, 0, 13);
 249   1          while (i <= 3)
 250   1          {
 251   2              Show_TimeString(44, 2, Alarm_Time, 4);
 252   2              OLED_DisplayStr(44, 4, "        ");
 253   2              if (i > 1)
 254   2                  OLED_DisplayChar(44 + i * 8 + 8, 4, 127); // æ˜¾ç¤ºå°ç®­å¤´æŒ‡ç¤ºè°ƒæ•´çš„ä½,æ­¤å¤„ifä½œç”¨æ
             -˜¯ï¼Œå¦‚æœè°ƒæ•´åˆ†é’Ÿæ•°ã€iã€‹1ã€‘æƒ…å†µï¼Œéœ€è¦è·³è¿‡ä¸€ä¸ªå†’å·ã€‚
 255   2              else
 256   2                  OLED_DisplayChar(44 + i * 8, 4, 127);
 257   2      
 258   2              switch (Key_Scan_Blocked())
 259   2              {
 260   3              case 1: // oké”®ï¼Œå½“å‰ä½+1
 261   3                  Alarm_Time[i]++;
 262   3                  if (Alarm_Time[i] > 9)
 263   3                      Alarm_Time[i] = 0; // ä»»æ„ä¸€ä½éƒ½ä¸å…è®¸å¤§äº9
 264   3                  break;
 265   3              case 2: // åˆ‡ä½é”®ï¼Œè°ƒæ•´ä¸‹ä¸€ä½
 266   3                  i++;
 267   3                  break;
 268   3              case 3: // å–æ¶ˆé”®ï¼Œé€€å‡ºè°ƒæ•´ç¨‹åºï¼ˆä¸ä¿å­˜ï¼‰
 269   3                  return;
 270   3              }
 271   2      
 272   2              if (Alarm_Time[0] * 10 + Alarm_Time[1] > 23) // åˆ¤æ–­å½“å‰æ—¶é—´çš„åˆæ³•æ€§
 273   2              {
 274   3                  Alarm_Time[0] = 0;
 275   3                  Alarm_Time[1] = 0;
 276   3              }
 277   2              if (Alarm_Time[2] * 10 + Alarm_Time[3] > 59)
 278   2              {
 279   3                  Alarm_Time[2] = 0;
 280   3                  Alarm_Time[3] = 0;
 281   3              }
 282   2          }
 283   1      }
 284          
 285          /// @brief æ˜¾ç¤ºæ ·å¼åˆ‡æ¢çš„é¡µé¢
 286          void Show_PatternSet()
 287          {
 288   1          unsigned char option;
 289   1      
 290   1          OLED_Fill(0);
 291   1      
 292   1          OLED_DisplayCN(16, 0, 12); // æ—¶é—´æ ·å¼è®¾ç½®
 293   1          OLED_DisplayCN(32, 0, 13);
C51 COMPILER V9.00   PAGE                                                                  01/08/2025 16:52:06 PAGE 6   

 294   1          OLED_DisplayCN(48, 0, 24);
 295   1          OLED_DisplayCN(64, 0, 25);
 296   1          OLED_DisplayCN(80, 0, 10);
 297   1          OLED_DisplayCN(96, 0, 11);
 298   1      
 299   1          OLED_DisplayCN(16, 2, 14); // æ—¥æœŸæ ·å¼è®¾ç½®
 300   1          OLED_DisplayCN(32, 2, 15);
 301   1          OLED_DisplayCN(48, 2, 24);
 302   1          OLED_DisplayCN(64, 2, 25);
 303   1          OLED_DisplayCN(80, 2, 10);
 304   1          OLED_DisplayCN(96, 2, 11);
 305   1      
 306   1          OLED_DisplayCN(16, 4, 12); // æ—¶é’Ÿé£æ ¼
 307   1          OLED_DisplayCN(32, 4, 17);
 308   1          OLED_DisplayCN(48, 4, 26);
 309   1          OLED_DisplayCN(64, 4, 27);
 310   1      
 311   1          // OLED_DisplayCN(16, 6, 29); //æ˜¾ç¤ºäº®åº¦è°ƒæ•´
 312   1          // OLED_DisplayCN(32, 6, 30);
 313   1          // OLED_DisplayCN(48, 6, 43);
 314   1          // OLED_DisplayCN(64, 6, 44);
 315   1          // OLED_DisplayCN(80, 6, 45);
 316   1          // OLED_DisplayCN(96, 6, 46);
 317   1          OLED_DisplayStr(16, 6, "About");
 318   1      
 319   1          option = Show_SelectBar(4); // æ­¤å¤„é˜»å¡
 320   1      
 321   1          switch (option)
 322   1          {
 323   2          case 1:
 324   2              OLED_Fill(0);
 325   2              OLED_DisplayCN(16, 0, 29); // æ˜¾ç¤ºç§’æ•°
 326   2              OLED_DisplayCN(32, 0, 30);
 327   2              OLED_DisplayCN(48, 0, 31);
 328   2              OLED_DisplayCN(64, 0, 32);
 329   2      
 330   2              OLED_DisplayCN(16, 2, 28);
 331   2              OLED_DisplayCN(32, 2, 29); // ä¸æ˜¾ç¤ºç§’æ•°
 332   2              OLED_DisplayCN(48, 2, 30);
 333   2              OLED_DisplayCN(64, 2, 31);
 334   2              OLED_DisplayCN(80, 2, 32);
 335   2      
 336   2              option = Show_SelectBar(2); // æ­¤å¤„é˜»å¡
 337   2              if (option == 1)
 338   2                  isShowSecond = 1;
 339   2              else if (option == 2)
 340   2                  isShowSecond = 0;
 341   2      
 342   2              break;
 343   2          case 2:
 344   2              OLED_Fill(0);
 345   2              OLED_DisplayCN(16, 0, 29); // æ˜¾ç¤ºå¹´ä»½
 346   2              OLED_DisplayCN(32, 0, 30);
 347   2              OLED_DisplayCN(48, 0, 33);
 348   2              OLED_DisplayCN(64, 0, 34);
 349   2      
 350   2              OLED_DisplayCN(16, 2, 28);
 351   2              OLED_DisplayCN(32, 2, 29); // ä¸æ˜¾ç¤ºå¹´ä»½
 352   2              OLED_DisplayCN(48, 2, 30);
 353   2              OLED_DisplayCN(64, 2, 33);
 354   2              OLED_DisplayCN(80, 2, 34);
 355   2      
C51 COMPILER V9.00   PAGE                                                                  01/08/2025 16:52:06 PAGE 7   

 356   2              option = Show_SelectBar(2); // æ­¤å¤„é˜»å¡
 357   2              if (option == 1)
 358   2                  isShowYear = 1;
 359   2              else if (option == 2)
 360   2                  isShowYear = 0;
 361   2      
 362   2              break;
 363   2          case 3:
 364   2              OLED_Fill(0);
 365   2              OLED_DisplayCN(16, 0, 37); // ç²—ä½“
 366   2              OLED_DisplayCN(32, 0, 38);
 367   2      
 368   2              // OLED_DisplayCN(16, 2, 39);
 369   2              // OLED_DisplayCN(32, 2, 40); // è¡¬çº¿ä½“
 370   2              // OLED_DisplayCN(48, 2, 38);
 371   2      
 372   2              OLED_DisplayCN(16, 2, 41);
 373   2              OLED_DisplayCN(32, 2, 42); // æ•°ç ä½“
 374   2              OLED_DisplayCN(48, 2, 38);
 375   2      
 376   2              option = Show_SelectBar(2); // æ­¤å¤„é˜»å¡
 377   2              if (option == 1)
 378   2                  Time_Fontstyle = 0;
 379   2              // else if(option==2)  Time_Fontstyle=1;
 380   2              else if (option == 2)
 381   2                  Time_Fontstyle = 1;
 382   2      
 383   2              break;
 384   2          case 4:
 385   2              OLED_Fill(0);
 386   2      
 387   2              OLED_DisplayStr(0, 0, "Use 2* AA BAT");
 388   2              OLED_DisplayStr(0, 2, "Or: Use Type-C");
 389   2              OLED_DisplayStr(0, 4, "DC Power");
 390   2              OLED_DisplayStr(0, 6, "Press Any Key");
 391   2      
 392   2              Key_Scan_Blocked();
 393   2      
 394   2              OLED_Fill(0);
 395   2      
 396   2              OLED_DisplayStr(0, 0, "Version: 1.0");
 397   2              OLED_DisplayStr(0, 2, "Compile Date:");
 398   2              OLED_DisplayStr(0, 4, "2025.1.8");
 399   2              OLED_DisplayStr(0, 6, "Press Any Key");
 400   2      
 401   2              Key_Scan_Blocked();
 402   2      
 403   2              OLED_Fill(0);
 404   2      
 405   2              break;
 406   2          default:
 407   2              break;
 408   2          }
 409   1          OLED_Fill(0);
 410   1      }
 411          
 412          // /// @brief æ˜¾ç¤ºè°ƒæ•´äº®åº¦ç•Œé¢
 413          // void ShowPage_BrightnessChange()
 414          // {
 415          //     unsigned char brightness;
 416          //     unsigned char option;
 417          
C51 COMPILER V9.00   PAGE                                                                  01/08/2025 16:52:06 PAGE 8   

 418          //     OLED_Fill(0);
 419          //     // OLED_DisplayCN(16, 0, 29); //æ˜¾ç¤ºäº®åº¦è°ƒæ•´
 420          //     // OLED_DisplayCN(32, 0, 30);
 421          //     // OLED_DisplayCN(48, 0, 43);
 422          //     // OLED_DisplayCN(64, 0, 44);
 423          //     // OLED_DisplayCN(80, 0, 45);
 424          //     // OLED_DisplayCN(96, 0, 46);
 425          
 426          //     OLED_DisplayStr(16,0,"100%");
 427          //     OLED_DisplayStr(16,2,"75%");
 428          //     OLED_DisplayStr(16,4,"50%");
 429          //     OLED_DisplayStr(16,6,"10%");
 430          
 431          //     option=Show_SelectBar(4);
 432          //     switch (option)
 433          //     {
 434          //         case 1:
 435          //             brightness=0xff;
 436          //             break;
 437          //         case 2:
 438          //             brightness=0xb2;
 439          //             break;
 440          //         case 3:
 441          //             brightness=0x7f;
 442          //             break;
 443          //         case 4:
 444          //             brightness=0x01;
 445          //             break;
 446          //     }
 447          //         OLED_Write_Byte(0x81, isCmd); //è®¾ç½®å¯¹æ¯”åº¦
 448          //         OLED_Write_Byte(brightness, isCmd); //å¯¹æ¯”åº¦,æ•°å€¼è¶Šå¤§å±å¹•è¶Šäº®ï¼Œ0x00-0xff
 449          // }
 450          
 451          /// @brief æ˜¾ç¤ºé—¹é’Ÿæ­£å“æ—¶åˆ»çš„ç•Œé¢
 452          void ShowPage_AlarmOn()
 453          {
 454   1          unsigned int n = 180;       //å¾ªç¯å˜é‡
 455   1          unsigned int k = 0xffff;    //å¾ªç¯è®¡æ•°å˜é‡
 456   1      
 457   1          OLED_Fill(0);
 458   1      
 459   1          OLED_DisplayCN(0, 6, 19);
 460   1          OLED_DisplayCN(16, 6, 48); // æŒ‰ä»»æ„é”®å…³é—­
 461   1          OLED_DisplayCN(32, 6, 49);
 462   1          OLED_DisplayCN(48, 6, 50);
 463   1          OLED_DisplayCN(64, 6, 51);
 464   1          OLED_DisplayCN(80, 6, 21);
 465   1          OLED_DisplayCN(96, 6, 52);
 466   1          OLED_DisplayCN(112, 6, 19);
 467   1      
 468   1          AlarmToggle(1); // æ‰“å¼€é—¹é’Ÿ
 469   1      
 470   1          while (n--) // å¾ªç¯ç­‰å¾…æŒ‰é”®æŒ‰ä¸‹
 471   1          {
 472   2      
 473   2              while (k--)
 474   2              {
 475   3                  DS1302_ReadTime();
 476   3                  Show_LargeTimeString(isShowSecond,Time_Fontstyle);  //é—¹é’Ÿå“æ—¶ä»ç„¶ä¿æŒæ˜¾ç¤ºå½“å‰æ—¶é
             -—´
 477   3      
 478   3                  OLED_DisplayCN(0, 0, 23);    //æ˜¾ç¤ºé—¹é’Ÿæ ‡è¯†
C51 COMPILER V9.00   PAGE                                                                  01/08/2025 16:52:06 PAGE 9   

 479   3                  Show_TimeString(16, 0, Alarm_Time, 4);  //æ˜¾ç¤ºè®¾å®šçš„é—¹é’Ÿæ—¶é—´
 480   3      
 481   3                  if (Key_Scan() != 0) // å¦‚æœæœ‰æŒ‰é”®æŒ‰ä¸‹åˆ™ç«‹å³é€€å‡ºï¼Œå¦åˆ™æŒç»­å¾ªç¯å¤§çº¦3åˆ†é’Ÿ
             -åå…³é—­
 482   3                  {
 483   4                      AlarmToggle(0);
 484   4                      OLED_Fill(0);
 485   4                      return;
 486   4                  }
 487   3              }
 488   2          }
 489   1          AlarmToggle(0);
 490   1          OLED_Fill(0);
 491   1      }
 492          
 493          /// @brief åœ¨å±å¹•æŒ‡å®šä½ç½®æ˜¾ç¤ºæ—¥æœŸå­—ç¬¦ä¸²
 494          /// @param form æ˜¾ç¤ºçš„å½¢å¼ï¼Œ1ä¸ºæ˜¾ç¤ºå¹´æœˆæ—¥ï¼Œ0ä¸ºåªæ˜¾ç¤ºæœˆæ—¥
 495          /// @param x 0-127
 496          /// @param y 0-7
 497          void Show_DataString(unsigned char form, unsigned char x, unsigned char y)
 498          {
 499   1          if (form == 1)
 500   1          {
 501   2              OLED_DisplayChar(x, y, '2');                        // æ˜¾ç¤ºå¹´ä»½åƒä½
 502   2              OLED_DisplayChar(x + 8, y, '0');                    // ç™¾ä½
 503   2              OLED_DisplayChar(x + 16, y, DS1302_Date[2] + 0x30); // åä½
 504   2              OLED_DisplayChar(x + 24, y, DS1302_Date[3] + 0x30); // ä¸ªä½
 505   2              OLED_DisplayChar(x + 32, y, '/');                   // åˆ†éš”ç¬¦
 506   2              OLED_DisplayChar(x + 40, y, DS1302_Date[4] + 0x30); // æœˆä»½åä½
 507   2              OLED_DisplayChar(x + 48, y, DS1302_Date[5] + 0x30); // æœˆä»½ä¸ªä½
 508   2              OLED_DisplayChar(x + 56, y, '/');                   // åˆ†éš”ç¬¦
 509   2              OLED_DisplayChar(x + 64, y, DS1302_Date[6] + 0x30);
 510   2              OLED_DisplayChar(x + 72, y, DS1302_Date[7] + 0x30);
 511   2          }
 512   1          else if (form == 0)
 513   1          {
 514   2              OLED_DisplayChar(x, y, DS1302_Date[4] + 0x30);
 515   2              OLED_DisplayChar(x + 8, y, DS1302_Date[5] + 0x30);
 516   2              OLED_DisplayChar(x + 16, y, '-');
 517   2              OLED_DisplayChar(x + 24, y, DS1302_Date[6] + 0x30);
 518   2              OLED_DisplayChar(x + 32, y, DS1302_Date[7] + 0x30);
 519   2          }
 520   1      }
 521          
 522          /// @brief æŒ‡å®šä½ç½®æ˜¾ç¤ºæ˜ŸæœŸå­—ç¬¦ä¸²
 523          /// @param form 0ï¼šæ˜¾ç¤º æ˜ŸæœŸå‡      1ï¼šæ˜¾ç¤º å‘¨å‡ 
 524          /// @param x 0-127
 525          /// @param y 0-7
 526          void Show_WeekString(unsigned char form, unsigned char x, unsigned char y)
 527          {
 528   1          if (form == 0)
 529   1          {
 530   2              OLED_DisplayCN(x, y, 0); // æ˜¾ç¤ºæ±‰å­—ï¼šæ˜ŸæœŸ
 531   2              OLED_DisplayCN(x + 16, y, 1);
 532   2              switch (DS1302_Week) // æ ¹æ®è¯»å–åˆ°çš„æ˜ŸæœŸå€¼ï¼Œæ¥ç¡®å®šæ˜¾ç¤ºå“ªä¸ªæ±‰å­—ï¼ˆä¸€äºŒä¸‰å››äº
             -”å…­æ—¥ï¼‰
 533   2              {
 534   3              case 1:
 535   3                  OLED_DisplayCN(x + 32, y, 2);
 536   3                  break;
 537   3              case 2:
 538   3                  OLED_DisplayCN(x + 32, y, 3);
C51 COMPILER V9.00   PAGE                                                                  01/08/2025 16:52:06 PAGE 10  

 539   3                  break;
 540   3              case 3:
 541   3                  OLED_DisplayCN(x + 32, y, 4);
 542   3                  break;
 543   3              case 4:
 544   3                  OLED_DisplayCN(x + 32, y, 5);
 545   3                  break;
 546   3              case 5:
 547   3                  OLED_DisplayCN(x + 32, y, 6);
 548   3                  break;
 549   3              case 6:
 550   3                  OLED_DisplayCN(x + 32, y, 7);
 551   3                  break;
 552   3              case 7:
 553   3                  OLED_DisplayCN(x + 32, y, 8);
 554   3                  break;
 555   3              }
 556   2          }
 557   1          else
 558   1          {
 559   2              OLED_DisplayCN(x, y, 9);
 560   2              switch (DS1302_Week)
 561   2              {
 562   3              case 1:
 563   3                  OLED_DisplayCN(x + 16, y, 2);
 564   3                  break;
 565   3              case 2:
 566   3                  OLED_DisplayCN(x + 16, y, 3);
 567   3                  break;
 568   3              case 3:
 569   3                  OLED_DisplayCN(x + 16, y, 4);
 570   3                  break;
 571   3              case 4:
 572   3                  OLED_DisplayCN(x + 16, y, 5);
 573   3                  break;
 574   3              case 5:
 575   3                  OLED_DisplayCN(x + 16, y, 6);
 576   3                  break;
 577   3              case 6:
 578   3                  OLED_DisplayCN(x + 16, y, 7);
 579   3                  break;
 580   3              case 7:
 581   3                  OLED_DisplayCN(x + 16, y, 8);
 582   3                  break;
 583   3              }
 584   2          }
 585   1      }
 586          
 587          /// @brief åœ¨oledå±å¹•æ­£ä¸­å¿ƒæ˜¾ç¤ºå¤§å·æ—¶é—´
 588          /// @param form 1:æ˜¾ç¤ºæ—¶åˆ†ç§’ 0ï¼šåªæ˜¾ç¤ºæ—¶åˆ†
 589          /// @param FontStyle å­—ä½“é£æ ¼ï¼Œ0ï¼šé»‘ä½“   2ï¼šæ•°ç æ—¶é’Ÿä½“    1ï¼šè¡¬çº¿ä½“
 590          void Show_LargeTimeString(unsigned char form, unsigned char FontStyle)
 591          {
 592   1          if (form == 1)
 593   1          {
 594   2              OLED_ShowLargeChar(0, 2, DS1302_Time[0], FontStyle);
 595   2              OLED_ShowLargeChar(16, 2, DS1302_Time[1], FontStyle);
 596   2              OLED_ShowLargeChar(32, 2, 10, FontStyle);
 597   2              OLED_ShowLargeChar(48, 2, DS1302_Time[2], FontStyle);
 598   2              OLED_ShowLargeChar(64, 2, DS1302_Time[3], FontStyle);
 599   2              OLED_ShowLargeChar(80, 2, 10, FontStyle);
 600   2              OLED_ShowLargeChar(96, 2, DS1302_Time[4], FontStyle);
C51 COMPILER V9.00   PAGE                                                                  01/08/2025 16:52:06 PAGE 11  

 601   2              OLED_ShowLargeChar(112, 2, DS1302_Time[5], FontStyle);
 602   2          }
 603   1          else if (form == 0)
 604   1          {
 605   2              OLED_ShowLargeChar(24, 2, DS1302_Time[0], FontStyle);
 606   2              OLED_ShowLargeChar(40, 2, DS1302_Time[1], FontStyle);
 607   2      
 608   2              if (blink_flag == 1) // å¦‚æœè¯¥æ ‡è¯†ç¬¦ä¸º1ï¼Œè¯´æ˜éœ€è¦æ˜¾ç¤ºå†’å·
 609   2              {
 610   3                  //blink_flag = 0;                           // åŒæ—¶æ ‡è¯†ç¬¦æ¸…é›¶
 611   3                  OLED_ShowLargeChar(56, 2, 11, FontStyle); // æ˜¾ç¤ºå†’å·
 612   3              }
 613   2              else // å¦‚æœä¸ä¸ºä¸€ï¼ˆä¸º0æ—¶ï¼‰
 614   2              {
 615   3                  //blink_flag = 1;                           // å…ˆæ ‡è¯†ç¬¦ç½®ä¸€
 616   3                  OLED_ShowLargeChar(56, 2, 10, FontStyle); // å†æ¸…é™¤å†’å·æ˜¾ç¤º
 617   3              }
 618   2      
 619   2              OLED_ShowLargeChar(72, 2, DS1302_Time[2], FontStyle);
 620   2              OLED_ShowLargeChar(88, 2, DS1302_Time[3], FontStyle);
 621   2          }
 622   1      }
 623          
 624          /// @brief oledæŒ‡å®šä½ç½®æ˜¾ç¤ºæ—¶é—´çš„å­—ç¬¦ä¸²ï¼Œå­—ä½“ä¸º8*16
 625          /// @param x 0-127
 626          /// @param y 0-7
 627          /// @param TimeString éœ€è¦æ˜¾ç¤ºçš„æ—¶é—´å­—ç¬¦ä¸²
 628          /// @param length éœ€è¦æ˜¾ç¤ºçš„é•¿åº¦ï¼Œå¦‚æœä¸º4åˆ™æ˜¾ç¤ºæ—¶åˆ†ã€ä¸º6æ˜¾ç¤ºæ—¶åˆ†ç§’
 629          void Show_TimeString(unsigned char x, unsigned char y, unsigned char *TimeString, unsigned char length)
 630          {
 631   1          OLED_DisplayChar(x, y, TimeString[0] + 0x30);
 632   1          OLED_DisplayChar(x + 8, y, TimeString[1] + 0x30);
 633   1          OLED_DisplayChar(x + 16, y, ':');
 634   1          OLED_DisplayChar(x + 24, y, TimeString[2] + 0x30);
 635   1          OLED_DisplayChar(x + 32, y, TimeString[3] + 0x30);
 636   1          if (length == 6)
 637   1          {
 638   2              OLED_DisplayChar(x + 40, y, ':');
 639   2              OLED_DisplayChar(x + 48, y, TimeString[4] + 0x30);
 640   2              OLED_DisplayChar(x + 56, y, TimeString[5] + 0x30);
 641   2          }
 642   1      }
 643          
 644          /// @brief æ­¤å‡½æ•°ä¸ºå„ç§é¡µé¢çš„é¡¹ç›®æä¾›ä¸€ä¸ªå¯ç§»åŠ¨çš„é€‰æ‹©æŒ‡ç¤ºç®­å¤´â†’ï¼Œå±äºé˜»å¡è¯
             -­å¥
 645          /// @param item å¯é€‰é¡¹çš„æ•°é‡,2-4
 646          /// @return ç”¨æˆ·é€‰æ‹©çš„é€‰é¡¹åºå·,è¿”å›0è¡¨ç¤ºé€€å‡º
 647          unsigned char Show_SelectBar(unsigned char item)
 648          {
 649   1          unsigned char i = 1;
 650   1      
 651   1          while (1)
 652   1          {
 653   2              OLED_DisplayCN(0, 0, 19); // å…ˆæ¸…é™¤æ‰€æœ‰çš„ç®­å¤´æ˜¾ç¤º
 654   2              OLED_DisplayCN(0, 2, 19);
 655   2              OLED_DisplayCN(0, 4, 19);
 656   2              OLED_DisplayCN(0, 6, 19);
 657   2      
 658   2              OLED_DisplayCN(0, i * 2 - 2, 18); // åœ¨å½“å‰ç”¨æˆ·é€‰æ‹©çš„ä½ç½®æ˜¾ç¤ºç®­å¤´
 659   2      
 660   2              switch (Key_Scan_Blocked()) // åˆ¤æ–­æŒ‰ä¸‹ä»€ä¹ˆæŒ‰é”®
 661   2              {
C51 COMPILER V9.00   PAGE                                                                  01/08/2025 16:52:06 PAGE 12  

 662   3              case 1: // æŒ‰ä¸‹okï¼Œåˆ™è¿”å›å½“å‰çš„æ‰€é€‰é¡¹
 663   3                  return i;
 664   3                  break;
 665   3              case 2: // æŒ‰ä¸‹åˆ‡æ¢ï¼Œåˆ™å½“å‰é€‰é¡¹+1ï¼Œä¹Ÿå°±æ˜¯ä¸‹ç§»ä¸€ä½
 666   3                  i++;
 667   3                  break;
 668   3              case 3: // æŒ‰ä¸‹å–æ¶ˆï¼Œåˆ™è¿”å›çš„é€‰é¡¹æ˜¯0ï¼Œè¡¨ç¤ºè¿”å›ã€‚
 669   3                  return 0;
 670   3                  break;
 671   3              }
 672   2              if (i > item)
 673   2                  i = 1; // å½“é¡¹ç›®æ•°åˆ°æœ€å¤§ï¼Œåˆ™å½’1
 674   2          }
 675   1      }
 676          
 677          /// @brief æ‰“å¼€æˆ–å…³é—­é—¹é’Ÿå“é“ƒ
 678          /// @param statue 0ä¸ºå…³ï¼Œ1ä¸ºå¼€
 679          void AlarmToggle(unsigned char statue)
 680          {
 681   1          Alarm_Pin = 1 - statue;
 682   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   3534    ----
   CONSTANT SIZE    =    120    ----
   XDATA SIZE       =      9      22
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
